<!--<!DOCTYPE html>-->
<html lang='en'>

<head>
  <meta charset='UTF-8'>
  <title>User Interface</title>

   <!-- Library scripts w/ local-fallbacks -->
   <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
   <script>window.jQuery || document.write("<script src='js/libs/jquery.min.js'>\x3C/script>");</script>
   <script src='https://cdn.jsdelivr.net/npm/vue/dist/vue.js'></script>
   <script>window.Vue || document.write("<script src='js/libs/vue.js'>\x3C/script>");</script>
   <!--<script src="/socket.io/socket.io.js"></script>-->

  <!-- Style sheets-->
  <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
  <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"/>
  <!--<link href='css/spacing.css' rel='stylesheet'></link>-->
  <!--<link href='css/shapes.css' rel='stylesheet'></link>-->
  <link href='css/style.css' rel='stylesheet'></link>
  <!--<link href='css/robots.css' rel='stylesheet'></link>-->
  <!--<link href='css/survey.css' rel='stylesheet'></link>-->


 
  <!-- Bootstrap-Vue -->
  <script src="https://unpkg.com/babel-polyfill@latest/dist/polyfill.min.js"></script>
  <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
  <!--<script src='js/survey.js'></script>-->
  <script src='js/libs/gup.js'></script>
  <script src='js/libs/vue.js'></script>
  <!-- Additional Bootstrap-->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="js/libs/easytimer.min.js"></script>
  <!-- Project scripts -->
  <script src='js/shared.js'></script>
  <script src='js/page.js'></script>
  


  <script language="JavaScript">
    var currentLayer = 'page1';
    function showLayer(lyr){
      hideLayer(currentLayer);
      //document.getElementById(lyr).style.visibility = 'visible';
      document.getElementById(lyr).style.display = '';
      currentLayer = lyr;
      history.scrollRestoration = "manual";
      $(window).scrollTop(0);
      
    }
    
    function hideLayer(lyr){
      //document.getElementById(lyr).style.visibility = 'hidden';
      document.getElementById(lyr).style.display = 'none';
    }
    
    </script>
    <!--<script type="text/javascript">

      // Get WebSocket
      //var socket = io();
      //var socket = io.connect('http://localhost:3000');

      // Get DOM elements
      //var input = document.getElementById("input");
      //var output = document.getElementById("output");

      // Join a channel
      //var room = "test";
      //socket.emit("join", room);
      
      /*
      */
      //socket.on("new_message", function (msg) {
      //  console.log("sending message through server", msg);
      //});
      let msg = "hello helloo helloooo";
      socket.on('connectToServer', function (msg) {
        
      socket.emit("new_message", msg);

      
      });

      function connectToServer(){
      socket = io.connect('http://localhost:3000');
      socket.emit("new_message", "connected to the server");
      //socket.on('connection', function (socket) {

        //  socket.on('newRemote', function (data) {
          //    console.log(data);
         // });
        //});
      };
    </script>-->
    
    <script>
      //const bc = new window.BroadcastChannel('wizard_communication');
      function openWindow() { 
		  linkIs = 'http://localhost/userInterfaceXAI-multiEvent-W/wizard.html?' 
      //to open the wizard in a new window
      // Check that an opener exists and is not closed
      console.log("window opener", window.opener);
      var myWindow = null;
      if(window.opener==null){
        //var myWindow = null;
        //$('.title').on('click', function(){
          if(myWindow == null || myWindow.closed)
            myWindow = window.open(linkIs, 'theWizardWindow');
          else
            myWindow.focus();
        //});


        //window.open(linkIs, "_blank", "theWizardWindow");
        //console.log("window opener in if", window.opener);

        

      }/*else{
        console.log("window opener in else", window.opener);
        if (window.opener && !window.opener.closed) {
          window.open(linkIs, "_blank");
          
        }
      }*/
		  
	    } 
      openWindow() 
    </script>
    
   
</head>

<body>
  

    <div id='header'>
      <p>Explainable Autonomous Vehicle</p>
      <!-- Help/instructions button -->
      <!--<button type="button" id='instructions-button' class="btn btn-secondary" data-toggle="modal" data-target="#instructModal" title="See instructions">Show Consent</button>-->
    </div>
    <!--<div id="page1" class="page" style="visibility:visible;">-->
    <div id="page1" class="page" style="display:'';">
      <div class="consent-text">
        <h1 style="text-align: center;">Study Consent</h1>
        <p> Explainability in autonomous vehicles. The ability to explain and justify the decision-making process of an Artificial Intelligence (AI) aids its trustworthiness, accountability, fairness, inclusivity, and accessibility. In this study, we explore the type of questions that a passenger of an autonomous vehicle might need to ask. Knowing what the questions are, we will make the autonomous vehicle capable of answering those questions. Only then can we explore the type of follow-up questions the passengers ask when in different driving scenarios. The results of our study will inform the design of explanation methods for autonomous vehicles. </p>
        <p> If you agree to be part of the research study, you will be asked to read and sign (by clicking the “I consent” button”) this consent form to be part of this study. Once you submit this consent form, you will be presented with multiple 30 seconds-long videos of the autonomous vehicle in which we assume you are sitting in and looking out the vehicle. We will ask you to explain what you think the autonomous vehicle in which you are in is doing. You can not replay the video(s) as you won’t be able to relive a real-life driving scenario. At this point, you can start asking questions, and the autonomous vehicle will try to answer your question as much as it can. After this step, we will ask you to answer a survey. In the survey, we will ask about the range of your age, gender, ethnicity, race, whether or not you have a driver's license, how long you have had your driver's license, which country you got your driver's license from, and if you are left-handed or right-handed. To get familiar with your thought process, we will ask you to think aloud while you are doing the task. We will screen capture the task (not you) and record your voice while you’re interacting with the interface. This will help us better analyze the data. We will show you the videos of a total of 6 driving events.</p>
        <b>Benefits of the research</b> <p>  Participating in this study may not benefit you directly, but it will help the research team and the AI community to learn about the need for explanation and the type of end-user questions in automated systems such as self-driving vehicles.</p>
          
        <b> Risks and discomforts </b><p> You might experience fatigue. You may see crash videos, and that can add additional discomfort. You may also be deceived while performing the task. You are allowed to pause during the task and continue from where you left off. Also, you can stop participating in the study at any time without any cost to you. You will not know all aspects of the study until your participation is complete.</p>
          
        <b> Data security and storage</b> <p> We will protect the confidentiality of your research records by not using any identifiable information, such as your name or email address, to identify you on any study records. Instead, a unique random identifier will be assigned to you. To minimize the risk of a data breach, we store all the content including the recordings on a password-protected server behind a firewall minimizing any such breaches.
  
            Information collected in this project may be shared with other researchers, but we will not share any information that could identify you.</p>
          
        <b> Compensation </b> <p> You will be compensated $15 (this task will, on average, take up to 60 minutes to complete resulting in approximately $15/hour compensation) for taking part in this study.</p>
          
        <p> Participating in this study is completely voluntary. You must be 18 years or older and reside in the US. Even if you decide to participate now, you may change your mind and stop at any time.  You may choose to stop participating in the study at any time for any reason. You can request to delete your profile at any time and withdraw from the study.</p>
          
        <p>If you have questions about this research study, please contact Dr. Somayeh Molaei, EECS, University of Michigan at smolaei@umich.edu </p>
          
        <p> As part of their review, the University of Michigan Health Sciences and Behavioral Sciences Institutional Review Board (IRB) has determined that this study is no more than minimal risk and exempt from on-going IRB oversight.
          </p>
      </div>
      <div class="consent-buttons">
        <input type="button" class="btn btn-success gap-md-top" value="I Consent" onClick="showLayer('page2')"></button>
        <input type="button" class="btn btn-success gap-md-top" value="Not Intrested" onClick="showLayer('page3')" style="margin-left: 5%;
        background-color: red;"></button>
      </div>
    </div>
    
    <!--<div id="page2" class="page" style="visibility:hidden;">-->
    <div id="page2" class="page" style="margin-top: 15px;display:none;">
      <div class='main-container' id='dynamic'>
        
        <div id='robot-container' class='wrapper' style="display: none ;" >
          <!--<div class='progress-counter' style="padding-bottom: 10px;padding-top: 5px;">
            <p>  {{objMessage}} </p>
          </div>-->
          <form id="quiz2" style ="padding-left: 10px; display:'';">
            <!-- Question 1 -->
            <h4>1. How do you categorize the driving event in the video you watched?</h4>
            <!-- Here are the choices for the first question. Each input tag must have the same name. For this question, the name is q1. -->
            <!-- The value is which answer the choice corresponds to. -->
            <label><input type="radio" name="q1" value="c1">
              Crash
            </label><br />
            <label><input type="radio" name="q1" value="c2">
              Near crash
            </label><br />
            <label><input type="radio" name="q1" value="c3">
              Not a crash or near crash
            </label><br />
            <label><input type="radio" name="q1" value="c4">
              Other
              <div class="row" style ="padding-left: 30px;">
                <textarea rows="1" cols="25" v-model='eventTypeText' style="background-color:rgb(209, 238, 247);"></textarea>
              </div>
            </label><br />
        
            <!-- Question 2 -->
            <h4>2. Could you describe what is happening in the driving event in the video you watched?(check all that apply)</h4>
            <!-- Here are the choices for the second question. Notice how each input tag has the same name (q2), but a different name than the previous question. -->
            <fieldset>         
              <input type="checkbox" name="userValidation" id="grs" value="grass" >Car is driving on the grass<br>      
              <input type="checkbox" name="userValidation" id="sk" value="sky" >Car is flying in the sky<br>      
              <input type="checkbox" name="userValidation" id="rd" value="road" >Car is driving on the road<br>           
              <input type="checkbox" name="userValidation" id="VisOB" value="visualOB" >There are visual obstructions.<br>      
              <input type="checkbox" name="userValidation" id="LightB" value="lightSB" >The road and surrounding environment is well lit.<br>      
              <input type="checkbox" name="userValidation" id="dryOrWetB" value="dryWetB" >The road is dry.<br>  
              <input type="checkbox" name="userValidation" id="trafficFLB" value="trafficFB" >The traffic flow is heavy.<br> 
              <input type="checkbox" name="userValidation" id="occLaneB" value="laneB" >The vehicle driving in the left lane.<br> 
              <input type="checkbox" name="userValidation" id="speedingB" value="speedB" >The vehicle is speeding.<br> 
              <input type="checkbox" name="userValidation" id="trafflightB" value="traffLB" >There is a traffic light.<br> 
              <input type="checkbox" name="userValidation" id="nearJunctionB" value="nearJuncB" >The vehicle is near a Junction.<br> 
              <input type="checkbox" name="userValidation" id="constructionZB" value="constructionB" >There is construction.<br>  
              <input type="checkbox" name="userValidation" id="VmanuverB" value="vManuverB" >The vehicle's Maneuver was safe and legal.<br> 
              <input type="checkbox" name="userValidation" id="densetrafficB" value="densetrafficB" >Traffic is dense.<br>       
            </fieldset> 
            <input type='button' id='continueChat' class="btn btn-success gap-md-top" value='Continue' v-on:click="continueToTheChat()" style="display: '';"></button>
            
          </form>

          <!-- Question 3 -->
          <form id="quiz3" style ="padding-right: 10px; display: none;">
            <h4>3. As a passenger of the self driving vehicle in the video you watched, if the autonomus car can answer any question you ask, what additional information whould you like to know?</h4>
            <h4>Please ask any question you have and then press <b>Enter</b> key. After you asked all your questions click on the button <b>No More Questions</b> to end your chat with the vehicle.</h4>

            <div id="container" class="container" class="wrapper">
              <!--<img src="https://cdn.pixabay.com/photo/2020/01/02/16/38/chatbot-4736275_960_720.png" height="400vh" alt="Chatbot clipart">-->
               <div id="chat" class="chat">
                <div id="messages" class="messages"></div>
                <!--<input id="input" type="text" placeholder="Write something..." autocomplete="off" autofocus="true" />-->
                <textarea id='uq1' rows="2" cols="50" placeholder="I am your vehicle, ask me questions." style="background-color:rgb(209, 238, 247);"></textarea>
                <!--<input type="text" name="inputText" id='uq1' rows="2" cols="50" placeholder="I am your vehicle, ask me questions." autofocus="true" style="background-color:rgb(209, 238, 247);">-->
              </div>
            </div>
            <!--<input type='button' id='askVehicle' class="btn btn-success gap-md-top" value='Ask Vehicle' v-on:click="askWizard()" style="display: '';"></button>-->
            <input type='button' id='noMore' class="btn btn-success gap-md-top" value='No More Questions' v-on:click="noMoreQuestion()" style="display: '';"></button>
          
          </form>
          <form id="quiz2After" style ="padding-left: 10px; display:none;">
            <!-- Question 1 -->
            <h4>4. How do you categorize the driving event in the video you watched after your conversation with the autonomous vehicle?</h4>
            <!-- Here are the choices for the first question. Each input tag must have the same name. For this question, the name is q1. -->
            <!-- The value is which answer the choice corresponds to. -->
            <label><input type="radio" name="q1After" value="c1">
              Crash
            </label><br />
            <label><input type="radio" name="q1After" value="c2">
              Near crash
            </label><br />
            <label><input type="radio" name="q1After" value="c3">
              Not a crash or near crash
            </label><br />
            <label><input type="radio" name="q1After" value="c4">
              Other
              <div class="row" style ="padding-left: 30px;">
                <textarea rows="1" cols="25" v-model='eventTypeTextAfter' style="background-color:rgb(209, 238, 247);"></textarea>
              </div>
            </label><br />
        
            <!-- Question 2 -->
            <h4>5. Could you describe what is happening in the driving event in the video you watched one more time? (check all that apply)</h4>
            <!-- Here are the choices for the second question. Notice how each input tag has the same name (q2), but a different name than the previous question. -->
            <fieldset>         
              <input type="checkbox" name="userValidationAfter" id="grsAfter" value="grass" >Car is driving on the grass.<br>      
              <input type="checkbox" name="userValidationAfter" id="skAfter" value="sky" >Car is flying in the sky.<br>      
              <input type="checkbox" name="userValidationAfter" id="rdAfter" value="road" >Car is driving on the road.<br>      
              <input type="checkbox" name="userValidationAfter" id="VisO" value="visualO" >There are visual obstructions.<br>      
              <input type="checkbox" name="userValidationAfter" id="Light" value="lightS" >The road and surrounding environment is well lit.<br>      
              <input type="checkbox" name="userValidationAfter" id="dryOrWet" value="dryWet" >The road is dry.<br>  
              <input type="checkbox" name="userValidationAfter" id="trafficFL" value="trafficF" >The traffic flow is heavy.<br> 
              <input type="checkbox" name="userValidationAfter" id="occLane" value="lane" >The vehicle driving in the left lane.<br> 
              <input type="checkbox" name="userValidationAfter" id="speeding" value="speed" >The vehicle is speeding.<br> 
              <input type="checkbox" name="userValidationAfter" id="trafflight" value="traffL" >There is a traffic light.<br> 
              <input type="checkbox" name="userValidationAfter" id="nearJunction" value="nearJunc" >The vehicle is near a Junction.<br> 
              <input type="checkbox" name="userValidationAfter" id="constructionZ" value="construction" >There is construction.<br>  
              <input type="checkbox" name="userValidationAfter" id="Vmanuver" value="vManuver" >The vehicle's Maneuver was safe and legal.<br> 
              <input type="checkbox" name="userValidationAfter" id="densetraffic" value="densetraffic" >Traffic is dense.<br>     
            </fieldset> 
            <input type='button' id='submit' class="btn btn-success gap-md-top" value='Submit your answers' v-on:click="logResponse()" style="display: none;"></button>
          
            
          </form>
          
        </div>

        <div id='object-container' class='wrapper'>
          <div class='progress-counter' style="padding-bottom: 10px;padding-top: 5px;">
            <p>  {{objMessage}} </p>
          </div>
          <h4>Imagine you are the passenger of the autonomous vehicle in the below video, sitting inside the vehicle, and looking out the dashboard in this driving scenario. You have no control over the vehicle. Please watch the video, and when done click on the button "I watched the video" to proceed to the next step.</h4>
          <div class="my-grid" id="theVidDiv" style="display:'';">
            
            <div class="one" id="theone" style="margin-left: -20%; margin-right: -1%;">Front view
              
              <div class="wrapper">
                <!--<div class="h_iframe">-->
                    <!--<iframe src="//www.youtube.com/embed/9KunP3sZyI0" frameborder="0" allowfullscreen></iframe>
                    <iframe src="media/sample1.mp4" type="video/mp4" controlsList="nodownload"></iframe>-->
                    <video id= 'instructvid' width="100%" height="100%" controls controlsList="nodownload nofullscreen noremoteplayback noplaybackrate disablePictureInPicture">
                      <source src="media/subset_videos/Event_ID_29714471_Front.mp4" type="video/mp4" autoplay="1">
                      
                    Oh no. This browser doesn't support our video.
                  </video>
                <!--</div>-->
                
              </div>
              <input type='button' id='VidWatched' class="btn btn-success gap-md-top" value='I watched the video' v-on:click="wideoWatched()" style="display: ''; margin-top: 2%;margin-left: 15%;"></button>
            </div>
              
          </div>
          

        </div>
        
      </div>
      <!--<input type='button' id='submit' class="btn btn-success gap-md-top" value='Submit Task' v-on:click="submitTask()"></button>-->

    </div>
    <!--<div id="page3" class="page" style="visibility:hidden;">-->
    <div id="page3" class="page" style="display:none;">
      <h1 style="text-align: center; margin-top: 10%;">Thank you. You can close this page now.</h1>
    </div>

</body>

</html>
